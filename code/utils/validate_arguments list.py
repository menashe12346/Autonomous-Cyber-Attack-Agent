import re
import json

# הדבק כאן את המחרוזת המלאה שלך – רק את הטקסט עצמו
raw_input = """-{n|m},*,exe_url, bad.ras,,,leak-size,userbuf, ignored,offset, allign(0..3),,hostname,stop|start,-LRdfnqrv, -c count, -i wait, -l preload,return address,,,RET ADDR,offset, align(0..3),,playertypes, -v, maxrank, playernames,RET, STARTING_RET, -r <RET>, -b [-s <STARTING_RET>,/path/to/file,address, length,uc tool path, file to overwrite, source file,file not in cache,offset, allign(0..3),retaddr, align,target, output,-,offset,user,,path+bin,,,retaddr, align,target, retloc, retaddr, offset, -l<retloc>, -r<retaddr>, -o<offset>,,path-to-chpasswd,RET ADDR,target, max file creation,retaddr,program, args,argument,target file,mountpoint,,,,logfile, OPTION...,wlen delta, try -32,...,32,.PDB filename,target, max file creation,,args...,gnome app,offset, align, buffer,,offset,offset, allign(0..3),-d, -b, -r, -s, -c executable,offset,.dtors address, offset, allignment, -o <offset> -A <allignment>,options,,,RET, STARTING_RET, -r <RET>, -b [-s <STARTING_RET>,-,target_shmid, trash,target, arg1, arg2, argn,.dtors address,UML_NET, pad,os_type,destination-file,PROG,HEAPADDR, GOTADDR,retaddr, outfile,options,wlen delta, try -32,...,32,ret, align,offset up/down, eip,cgi-script,filename, openmovieeditor,return address, offset,big file name,ompress, ecompress,,buffer_to_overflow,RETloc, offset, num, align, buffsize, eggsize,png,,0x00,file-exploit, return address,args,key_name,d | s | r | p,,command_name,file_path,,,+,key_name,,offset,musicqueue.cgi path,,ip address, =,-i interface,port,hostname running upsd,host,file_to_read,targetport,Host, Ip, NickToUse, ChannellToJoin,,fe80::1:2:3, 00:11:22:33:44:55, eth0,fe80::1:2:3,elf_file_to_patch,Target IP, NTP Server IP,Target, Port,IP,number,host, # of connections,host, port, -h, -v, -d <host>, -p <port>,host_address, port, user_name, password, database_name, -P <port>, -d <database_name>,,pid to kill,targetip, targetport,IP_to_flood, Server_IP, kBps_to_use, #_packets,smtpserver,,,udp_size,path conkyrc,IP,,host, update-domain,target, spoofed srcip,interface, drivername,hostname,uppercase victim's netbios name, victim's ip,-s sport, -d dport, -n count, -u delay,ip_addr, port,,targetip, targetport,target IP, port, reflection file, threads, pps limiter, -1 for no limit, time,,target addr,src, dst,attack, output_file,,interface, src ip, src port, dst ip, dst port, gateway/destination MAC,port, target,host,targetip, targetport,Host, Ip, NickToUse, ChannellToJoin,hostname/IP,,destination-IP, source-IP, spoofed-IP,-d hostname, -p port, -t target, -l, -V, -h,-m outfile, -o offset, -h,option, arguments,option, arguments,pad count, addr of jmp *%%esp,-h, -v, -a, -D, -m,host, port, attacker ip, type,,,offset,target, printer, user, userhost,-h host, -p port, -t target,retaddr, align,-h www.victim.com, -p port, -t target, -r manual_retaddr,host, offset [--debug,host, port, option,pppppppal at yahoo dot com, target ip, retaddr offset,host, port, xhost ip,Bindshell, Reverseshell, CONNECTBACK IP,IP | HOSTNAME, offset,port, def=3128,host,platform, host, offset,retaddr, ownage method c b o p r,options,align_val, offset_val,host, padding, retloc, retaddr,-h host, -t type, -p port,victimip, shellport,host,ip, port, target,Target id, Host, Offset, Server port, <Server port>,server ip[:port], :port,target host, target type, port (22 default),-h www.victim.com, -p port, -t target, -r manual_retaddr,Host,num, p#, source, dest, -t <num>, -p <p#>,host, padding, retloc, retaddr,host, options,options,host, userlist, options,opts,,pppppppal at yahoo dot com, target ip, retaddr offset,-t type, hostname, -o offset,host, port, conn-back host, input port, output port,-p PORT, -t TARGET, -f FILE, -r RET, -v,,ip of the victim,,offset,your_ip, host, dir, -l name pass, offset align,retaddr,,,,offset, victim,-pah,options,-options,,Email Address, offset,IP_ADDRESS, COOKIE,host, port, offset-add,(NRL),-nopoke,-s, -e,-h host, -b connect IP, -u user, -p pass, -p port, -v, -t target,username, password,hostname, ret address in hex (0x41414141),,host, port, target, offset, -o <offset>,host, user, pass,,RET, STARTING_RET, DIFF, -r <RET>, -b [-s <STARTING_RET>, -d <DIFF>,port, -p<port>,hostname,:port, Option(s),,login, password, offset, target, <offset>,target ip, target number, offset [1..4096], 1..4096,offset,host, target,tip, tport, cbip, target,interface, driver, channel, arptype,path, port, ret, target, -f <path>, -p <port>, -r <ret>, -t <target>,victim host, victim port,Target ip, Login, Password,-c ip address, -l file, -p port,-t, -p port, -a addr, -l len,-H, -i, -t 0xtable-address, -a 0xthread-address, [-s socket, -h host, -p port, -x,-cp, ip,attack, host, port(%hu),host, port,retaddr, align,target, host, send delay in ms,host, target,-l login -p passwd, -d dir, -o offset, -a align,target#, evil.mp3 name,ipaddr, port,cmd,target, X server, tt, opt, offset,,remote host, brute force start return address,remotehost, user, pass, writeable directory,options, host[:port,-cp, ip,host, port,,ip,,host, port,-g pad, -j jump_address,,Host, parameters,user@where.com,base of nonce buffer,target, offset,\"brute\", -o offset, -a align, -p position, -r eip_addr, -c shell_addr, -w written_bytes,,host, type,,port,,IP_ADDRESS, TARGET,(NRL),,host, username, password, -c, -s start_dir,hostname/IP,source host, target host, -s <source host>,host, options,host, tt, opt, ofst,ip, port,host, script, port, -h, -v, -r, -d <host>, -s <script>, -p <port>,,option, arguments,Target ip, Login, Password,retaddr, outfile,options, ip_address, password, username, gotaddr, retaddr,,offset, host,client_ip, client_port, server_ip, hex_session, address,IP,-pah,,,hostname/IP:feathers, -,option, arguments,opts,,port, l_ip, l_port, targ,attack, output_file,type, RemoteHost,protocol version, user file, host,attack, file_to_create,options,-h host, -t type, -p port,offset, target, <offset>,,,,tip, tport, cbip, target,buffer size, offset,hostname,,,target#,opts,printername, egg,offset,-a|-p|-l|-d|-c|-h,-o offs, -r ret, -a indent,command, offset,filename, bsd|linux,-a|-p|-l|-d|-c|-h,bufsize, align, offset,offset,command,ip, port,host, phpbin, port, maxsocks,target,port, -c N,host, version number,host, command, port, offset, -p <port>, -o <offset>,target, -l user/pass, -s systype, -o offset, -g, -h, -x,hostname, user, pass,hostname, command, offset,target, namefile, passwordfile, -a,IP | HOSTNAME, offset,host, offset,your_ip, victim ip, hostname len,host, icecast port, type, allign, address of *expr, -t <type>, -a <allign>  -b <address of *expr>,,-k pid, -t ttl, -b ip,,(NRL),host, display, offset,(NRL),port, -c N,,-l localaddr, -b localport, -p ptr,saved eip, count, packet length, username length, host,target,host, port,-p port, -l,type, victim, your_ip,-ku, -p port, -f outfile,-t target, -p port, -h,,-h www.victim.com, -p port, -t target, -r manual_retaddr, -b addr, -s step_num,port, -c N,-s|-c command, -p port, -v 5,options,,,,binary,,offset,filetype,hostname,ip, port,Usage,GalleryPath,host, /path/, site, cmd,hostname, path to printthread.php, Any vaild forum name, user id,host, /folder/, user_id,host, /folder/, cmd,server, path, username, password,version, dir, option, start, end,,victim, admin_login, forum_directory,options,,-p path, -u user, host, -b beginchar, -e endchar, port,,options,,offset,target#,allproc,-t target, -o offset,host, port,,,,host, target,off,off,host,host,,file.mp4,file.psp,,2,file.ani,filename, targ,file.ttf,output PLS file, JMP, Exploit Display Name,filename, url, targ,filename, -r 0xdeadbeef,2||atoi(argv[1]), 1, 1,directory_path,,file.fpx,target,filename.mdb,outputfile,file.clp,processid to elevate,cmd.exe,file.bmp,output M3U file, JMP, M3U Display Name,cimopuvy, -f archive, -s replstr, -t device,Group, file.reg,,processid to elevate,,,output PLF file, JMP,outputfile,,output ASX file, JMP,uncompressed h3m filename, target #,,ifNum, numOfBits,,attack, output_file,,file.ras,encrypted.cfm,XP, 2K,-t target, -r return address,dmc@deadbeef.co.uk, output file,file.png,language, option,file.ani,cimopuvy, -f archive, -s replstr, -t device,processid to elevate,host, target,processid to elevate,OPTION, SPECIFICATION,file.xpm,,trojan, CNT file, offset,output_file.XM,file.psp,XP, 2K,attacker host, attacker port,i+1,account name, encrypted password,command to be executed, Key to trap,path to Local Network.FCP,,,processid to elevate,output CUE file,processid to elevate,infile, outfile, <outfile>,file.ani,Target, OutputPath,target, file,file.xpm,target,output M3U file, JMP,file.ani, target,cmd.exe,ip,malformed_collada_xml_path,processid to elevate,file.iff,XP, 2K,printer_name, fullpath_monitor_dll, rel_path_monitor_dll, new_dll, counter,,processid to elevate,file,path to Local Network.FCP,volume file,processid to elevate,processid to elevate,host,attack, port(%d),ip, port, user, pass,host, port(%d),host, port(%hu),client-ip,servers, src, server_port, delay,server, port, options,option1,target hostname,PORT,hostname [port,targetip, targetport,attack, server, port, loop,victim, source,hostname, type,type, num,IP,hostname, port,Target IP,host/ip,victim, source,host, port,output PLS file,host, port(%d),destination, source,ip, mysystem,target, source,IP_Address, port,attack, host, port(%hu),,attack, host, port(%hu),Server IP, TCP/UDP, Send Count, Usage: %s <Server IP> <TCP/UDP> <Send Count>\n", argv[0,smtp server,host, port(%d),server, options,host, port(%d),Target IP,hostname, port,dest ip, dest port,dstaddr, dstport, pktsize, pps,ip, port,target IP address,host, options,host, port, pre, post,,attack, host, port(%hu),host, port(%hu),host name|ip address,-l, -r server IP,WhU, GiN, LByte, WGHACK,host, port,profiled IP/destination, src IP(fake),attack, host, port(%d),target, source,port, NumP, Numt, NumR, NumF, NumD,-s src_addr, -p port,paylen,ip,target, -v, -f, string_lenght, port,,ip,targetip, targetport,Usage:,version,IP Address,host, port(%d),ip, port,host, port,dst, src, size, number,server, port(%d),target ip,host, port(%hu),attack, host, port(%hu),device, target, GRE key,,victim,host, port, localip,hostname, (this*4026) bytes per message, username_of_target, number_of_messages,attack, host, port(%hu),server,type, num,host,,targetip, targetport,host, port,attack, host, port(%hu),host, port(%hu),host, remote_file, local_file, options,HOST,hostname, port, user, password,d/p, host,attack, port(%d),file.ani,server, port,host name|ip address,game, port,target,host, port(%d),attack, host, port(%d),attack, host, port(auto),server, port(%d),www.target.com,+, port,output M3U file,,Target IP,ip,dstaddr, dstport, srcaddr, srcport,server, port(%u),host, port(%d),HostIP / HostName,ret_addr, host, port(%d),ip,target ip, port,host, port(%d),,host, port(%d),output_file.IT,host,src, dst,3)||(argc, 1)||(atoi(argv[1]), 1, 1,3)||(argc, 1)||(atoi(argv[1]), 1, 1,server, port(%d),smtp server,ip, port,attack, host, port(%hu),version,hostname, port,server, port(%d),,,host, port(%d),host, port(%hu),port, target,attack, port(%d),src, dst,host, port,hostname, port,attack, file.VMO,target, port,*,-s src_addr, -p port,ip, 0=flood, 0=rand, 0=none,targetIp, targetPort,ip of server,ip, port,attack, port(%d),,Target Url or IP,host, port, localip,port, target,host/ip,hostname,attack, server, port(%d),port, NumP, Numt, NumR, NumF, NumD,host, port(%hu),attack, host, port(%hu),Target IP,password,host, port(%d),I.P./Hostname,attack, output_file,host, port(%d),host, port, login, password,ip address,,,target, type,attack, host, port(%d),host, options,HOST,I.P./Hostname,dest ip, dest port,options,Host, Port,host,type, num,port, target,ip, port,host, port(%hu),host, port(%d),,,host,client-ip,,ip, cbip, cbport,< "Usage: " << argv[0] << ".exe -h <ip, port,hostname,target, victim_ip, command to execute,,+, port,,targetip, targetport,Options,host, port, l_ip, l_port, targ,< "Usage: testgd <host, time_string,port_to_exploit, retnaddr, retport, target, address,target_IP, user, pass,ip, port,target host, target number,,,,,IPADDRESS, PORT, TARGET,ip, command,port,hostname,Usage:,,IP,-ht,attack, host, port(%hu),TargetIP, TargetPort, YourIp, YourPort,OutputPath, Url,IP, PORT,victim-host, connectback-ip, connectback port,hostname,shell type, template doc, os, port, ip, <ip>,server, port(%d),hostname|ip, port=27015,attack, host, port(%hu),ip, id,host,victim host, victim port,,3||atoi(argv[1]), 1, 1,ip, port,hostname, command,ip address, -vqh, -t timeout,hostname, port, commands,trojan, CNT file, offset,3||atoi(argv[1]), 1, 1,,victim, port, target,3||atoi(argv[1]), 1, 1,-pah,ip, command,target_ip,IP_ADDRESS,,host,server, port,exe_URL, htmlfile,5)||(argc, 1)||(atoi(argv[1]), 1, 1,Target IP, Port,hostname, type,mode, offset,victim_host, type,Host, OS, Imail Version,URL,-t,targetport,targetip, targetport,URL, htmlfile,,,hostname/IP, port 80=default, Method see below,2)||(argc,output html file, 1,Host,victim host, victim port, attacker host, attacker port,ip,,target, file,ip, port,valid_file,IPADDRESS, PORT,,,victim, connectback ip, cb port, target,-h, -t TARGET, -p PORT, ARG=VAL,3||atoi(argv[1]), 1, 1,targethost, iwebport, localhost, localport,target host, port,ip_dest, options,target, port, type,,localhost, localport,,TargetIP, ver: 0 | 1,host, port, l_ip, l_port, targ,url,roman@rs-labs.com, target host, target port, bind port, ret,PORT,host,victim, port, url, version,OutputPath, Url,mode,target,tip, tport, cbip, cbport, target,host, port(%hu),OS-type,host, system,asp-path,hostname, number,host, username, password,ip, Options,exe_URL, htmlfile,address,host, isapi, port,vicHost, vicPort, atckHost, atckPort, ret 1-26, vicHost, shellPort, vicPort, ret 1-26, <ret 1-26>, <shellPort>, <vicPort>, <ret 1-26>,2)||(argc,port, Target,IP, Port, Version Name,Payload, JMP, hostname, port,ip, port,C:\, target host, target number,IP, PORT, username,ip, DLL,3)||(argc, 1)||(atoi(argv[1]), 1, 1,IP address, NetBIOS name,host, target,,ip, ip, cbip, cbport, bindshell, reverseshell,host, admin_port,server, aspfile, webport, winxp,URL, htmlfile,IP, Port, OS,ip, ip, cbip, cbport, bindshell, reverseshell,victim-host, connectback-ip, connectback port,ip_dest, options,,hostname,direct | free, -l, -r server IP,host, port, targ,smtp server,IP-addr or hostname, username to add,,ip,host, port(%hu),-i ip, -t type, -u user, -p pass, -d dir, -f ftpport, -c cbhost, -s shellport,-t target, -c 'command' or -i,victim,DIRECTORY,host,URL, htmlfile,Target IP, command to execute remotely, smtp port,file.png,Usage,3||atoi(argv[1]), 1, 1,victim, connectback ip, cb port, target,options,ip,bug, host, port(%hu),server, port(%d),port, Target, address,target, type,victim, port,:port, bindport,targethost, controlport, localhost, localport,system, connectback_IP, connectback_port,Target ID, Target IP,-i ip, -t type, -u user, -p pass, -l pathlen, -P port,3)||(argc, 1)||(atoi(argv[1]), 1, 1,ipv4dot, port, buffsize, retaddr, <buffsize>, <retaddr>,URL, htmlfile,# OS RET,host, port, port,DownloadUrl, OutputPath,connectback ip, connectback port,mail_addr, tftp_server, smtp_server,IP,EasyCafe Server IP, EasyCafe Client IP,,host, host, connectback ip, connectback port, Bindshell, Reverseshell,,hostname/IP, port 80=default, Method see below,Local htmlfile,IP, Port, Option,1)||(atoi(argv[1]), 1, 1,,ID, opt, host, user, pass, connectback_IP, connectback_port,port, trojan url,=v9.20\n(C) dmc <dmc@deadbeef.co.uk, ip, port, user, password,Target IP, command to execute remotely, smtp port,,address,URL, htmlfile,player_nick,host, port, buf_size, struct offset, free_hook, shellcode,remote_os,zip_file,distro, offset,file,hostname, eip, ebp,targetip, targetport,type, server, port(%u),hostname/IP,output.ADZ,src, server,dst ipv6,host/ip,host,host_address, port, user_name, password, database_name, -P <port>, -d <database_name>,attack, host, port, commandLength(0x%08x),attack, output_file,host, port, options,output.MP3,src ip, src port,attack, port(%d),host,host, port(%hu),target_hostname, port,output_file.GT2,sphere ip, sphere port,Host, Port,target, spoofed srcip,-6, port, delay (ms), times,host, port(%hu),,,host, port,hostname,output_file.NSF,,,elf_file_to_patch,,interval, port, pkts,host, [start, end,host, port(%hu),device, source_ip, src_mac, dst_ip, dst_mac, offset,host, zone,Count, Filter,host, port(%hu),,,port,host, bugs, options,-c command,-switches, :80,hostname,host, port,host, command,target#|base address, ip[:port], :port,,hostname, port,-t, -s|-c command, -p port, -v 5|6|7,,host,host, port, user,,[http://]server[:port(%d)], options, http://, :port(%d),hostname, command, offset,-t type, hostname, -l login, -o port, -f retofs, -s retlocofs,Host, OS,host, port(%hu),host,ftp-client, port-to-open, -w win,*kilobytes, number_of_connections, server, port(80),source ip, dest ip,-bBcCdfprsStv, host,host, port, file,,malicious_file, \"fake_file_name\", file.umod/ut2mod,hostname, port, directory,,,sniffit host,host, port,ip-querier, ip-resolver, ip-authoritative,source ip, dest ip,,PATH ...,,target#,offset,sudo full path command, sudo command,offset, alignment,elf_exec,,elf_executable,victim, host-file, loop host-file,source ip, dest ip, dest port,destination IP,pid you own,[0x]size of segments, 0x,num, ip, -n <num>, -c, -f,options,port, def=3128,-h host, -f port, -u user, -p pass, -d directory, -t type, -r retaddr, -c command,,,-v 62|63|64|65,-u username, -i userid, -p,source_router, dest_addr, command,filename (.pls), offset,size, outfile,ip address,dst addr, zone, src addr,signed macho-o binary,,icqclient, port,host,macho-o binary,IP_ADDRESS,hostname,host,Targ3t, DIR, File Address,host, ip, -s Script, -p Path, -o Port, -c Commands, -u,remote_host, command, path, http server port, target,host, port,host, command,host,-s retaddr, -a shellcodeoffset, -o offset,IP,vulnerable website,host, port, l_ip, l_port, targ,...,-fndq, name | nickname,,offset,-s size, -o offset, -p fpad_len,retloc,offset, NOPS, BUFSIZE,retloc, align, num, bufsize,opts,buffersize, offset,options,,retloc, offset,safe_addr,-b buffsize, -s stackoff, -p pad,offset,shell_offset, ret_addr_offset,-o offset, -a alignment,,offset,outsize,-,outsize,offset,target,dst,IP,dst,-ku, -p port, -f outfile,IP,dst,-s size,-p port,id, host, command, -i <id>, -t <host>, -c <command>,options,-o offset,-s size,-p port, -o ofs, -b, -m,-o offset,arch,,[-t, -r return address,cachename, command,-s, -e,ip-address, port,host,32-bit uid value in hexadecimal format,victim,dstaddr, saddr, number,,source_addr, dest_addr,-s source, -d dest, -c community,-s src_addr, -p port,source ip, destination ip,host, port,interface, vtp_domain,,port,destination IP, source IP, -s <source IP>,src ip, dst ip, hops, number,target, ttl,device,-s source, -d dest, -c community,REQ/REPLY, intf, srcMAC, srcIP, queryIP, nr of pkts, delay in ms, dstMAC, <dstMAC>,victim,,victim IP,3com_router, port,,,host,AP/Host, port,-n number of packets, -s source ip_addr,source_addr, dest_addr,ip, pass, passlist, -u user, port,,IFNAME,-s source, -d dest, -c community,dir, output file,router IP, new_password,host, PSK,,target IP address"""  # ← כאן תכניס את כל המחרוזת שלך

def clean_argument(arg: str):
    arg = arg.strip()
    if not arg or arg in {'0', '-', '*'}:
        return None
    # הסרה של תווי פורמט לא רלוונטיים
    arg = re.sub(r'[^a-zA-Z0-9_\-/\. ]', '', arg)
    # הסרת דגלים של שורת פקודה (כגון -i ip)
    tokens = arg.split()
    if len(tokens) > 1 and tokens[0].startswith('-'):
        return tokens[1]
    # אם זו מילה אחת והיא מתחילה במקף – נפסול
    if arg.startswith('-'):
        return None
    return arg.lower()

def extract_clean_arguments(raw_input: str):
    # פיצול לפי פסיקים
    tokens = raw_input.split(',')
    cleaned = set()
    for token in tokens:
        arg = clean_argument(token)
        if arg:
            cleaned.add(arg)
    return sorted(cleaned)

# חילוץ הארגומנטים
final_args = extract_clean_arguments(raw_input)

# שמירה לקובץ טקסט
with open("cleaned_arguments.txt", "w") as f:
    f.write(", ".join(final_args))

# שמירה לקובץ JSON
with open("cleaned_arguments.json", "w") as f:
    json.dump(final_args, f, indent=2)

print(f"[✓] Extracted {len(final_args)} clean arguments and saved to files.")
